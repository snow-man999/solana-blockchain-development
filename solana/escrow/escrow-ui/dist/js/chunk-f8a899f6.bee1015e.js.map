{"version":3,"sources":["webpack:///./src/Bob.vue?98d4","webpack:///./src/Bob.vue","webpack:///./src/Bob.vue?e95f","webpack:///./src/util/takeTrade.ts"],"names":["_hoisted_1","class","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","key","style","_hoisted_18","_hoisted_19","render","_ctx","_cache","$props","$setup","$data","$options","_openBlock","_createElementBlock","_createElementVNode","for","_withDirectives","type","id","$event","formState","privateKey","placeholder","disabled","loading","_vModelText","programId","takerXAccAddress","takerYAccAddress","escrowAccAddress","XTokenExpectedAmount","min","value","onClick","args","resetUI","onTakeTrade","isFormValid","_createCommentVNode","errorMessage","_toDisplayString","successMessage","defineComponent","setup","reactive","ref","computed","trim","async","takeTrade","err","Error","message","String","__exports__","connection","Connection","privateKeyByteArray","escrowAccountAddressString","takerXTokenAccountAddressString","takerYTokenAccountAddressString","takerExpectedXTokenAmount","programIdString","takerAccount","Account","split","map","s","parseInt","escrowAccountPubkey","PublicKey","takerXTokenAccountPubkey","takerYTokenAccountPubkey","encodedEscrowState","getAccountInfo","data","decodedEscrowLayout","ESCROW_ACCOUNT_DATA_LAYOUT","decode","escrowState","isInitialized","initializerAccountPubkey","initializerPubkey","XTokenTempAccountPubkey","initializerTempTokenAccountPubkey","initializerYTokenAccount","initializerReceivingTokenAccountPubkey","expectedAmount","BN","PDA","findProgramAddress","Buffer","from","exchangeInstruction","TransactionInstruction","Uint8Array","of","toArray","keys","pubkey","publicKey","isSigner","isWritable","TOKEN_PROGRAM_ID","sendTransaction","Transaction","add","skipPreflight","preflightCommitment"],"mappings":"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","file":"js/chunk-f8a899f6.bee1015e.js","sourcesContent":["import { createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString } from \"vue\"\n\nconst _hoisted_1 = { class: \"bg\" }\nconst _hoisted_2 = { class: \"mb-1\" }\nconst _hoisted_3 = [\"disabled\"]\nconst _hoisted_4 = { class: \"mb-1\" }\nconst _hoisted_5 = [\"disabled\"]\nconst _hoisted_6 = { class: \"mb-1\" }\nconst _hoisted_7 = [\"disabled\"]\nconst _hoisted_8 = { class: \"mb-1\" }\nconst _hoisted_9 = [\"disabled\"]\nconst _hoisted_10 = { class: \"mb-1\" }\nconst _hoisted_11 = [\"disabled\"]\nconst _hoisted_12 = { class: \"mb-1\" }\nconst _hoisted_13 = [\"disabled\"]\nconst _hoisted_14 = { class: \"mb-1\" }\nconst _hoisted_15 = [\"disabled\"]\nconst _hoisted_16 = [\"disabled\"]\nconst _hoisted_17 = {\n  key: 0,\n  style: {\"margin-left\":\"10px\"}\n}\nconst _hoisted_18 = {\n  key: 0,\n  class: \"mb-1 error-message\"\n}\nconst _hoisted_19 = {\n  key: 1,\n  class: \"mb-1 success-message\"\n}\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _cache[14] || (_cache[14] = _createElementVNode(\"p\", { class: \"title\" }, \"Escrow UI - Bob's Trade Interface\", -1)),\n    _createElementVNode(\"div\", null, [\n      _createElementVNode(\"div\", _hoisted_2, [\n        _cache[8] || (_cache[8] = _createElementVNode(\"label\", { for: \"bob-private-key\" }, \"Throwaway private key (as byte array from sollet.io, without the '[]')\", -1)),\n        _withDirectives(_createElementVNode(\"input\", {\n          class: \"display-block\",\n          type: \"text\",\n          id: \"bob-private-key\",\n          \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((_ctx.formState.privateKey) = $event)),\n          placeholder: \"e.g. 1,2,3,...\",\n          disabled: _ctx.loading\n        }, null, 8, _hoisted_3), [\n          [_vModelText, _ctx.formState.privateKey]\n        ])\n      ]),\n      _createElementVNode(\"div\", _hoisted_4, [\n        _cache[9] || (_cache[9] = _createElementVNode(\"label\", { for: \"bob-program-id\" }, \"Program id\", -1)),\n        _withDirectives(_createElementVNode(\"input\", {\n          class: \"display-block\",\n          type: \"text\",\n          id: \"bob-program-id\",\n          \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((_ctx.formState.programId) = $event)),\n          placeholder: \"Program ID\",\n          disabled: _ctx.loading\n        }, null, 8, _hoisted_5), [\n          [_vModelText, _ctx.formState.programId]\n        ])\n      ]),\n      _createElementVNode(\"div\", _hoisted_6, [\n        _cache[10] || (_cache[10] = _createElementVNode(\"label\", { for: \"bob-taker-x-acc\" }, \"Bob's X token account pubkey\", -1)),\n        _withDirectives(_createElementVNode(\"input\", {\n          class: \"display-block\",\n          type: \"text\",\n          id: \"bob-taker-x-acc\",\n          \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event: any) => ((_ctx.formState.takerXAccAddress) = $event)),\n          placeholder: \"X Token Account Pubkey\",\n          disabled: _ctx.loading\n        }, null, 8, _hoisted_7), [\n          [_vModelText, _ctx.formState.takerXAccAddress]\n        ])\n      ]),\n      _createElementVNode(\"div\", _hoisted_8, [\n        _cache[11] || (_cache[11] = _createElementVNode(\"label\", { for: \"bob-taker-y-acc\" }, \"Bob's Y token account pubkey\", -1)),\n        _withDirectives(_createElementVNode(\"input\", {\n          class: \"display-block\",\n          type: \"text\",\n          id: \"bob-taker-y-acc\",\n          \"onUpdate:modelValue\": _cache[3] || (_cache[3] = ($event: any) => ((_ctx.formState.takerYAccAddress) = $event)),\n          placeholder: \"Y Token Account Pubkey\",\n          disabled: _ctx.loading\n        }, null, 8, _hoisted_9), [\n          [_vModelText, _ctx.formState.takerYAccAddress]\n        ])\n      ]),\n      _createElementVNode(\"div\", _hoisted_10, [\n        _cache[12] || (_cache[12] = _createElementVNode(\"label\", { for: \"bob-escrow-acc\" }, \"Escrow account pubkey\", -1)),\n        _withDirectives(_createElementVNode(\"input\", {\n          class: \"display-block\",\n          type: \"text\",\n          id: \"bob-escrow-acc\",\n          \"onUpdate:modelValue\": _cache[4] || (_cache[4] = ($event: any) => ((_ctx.formState.escrowAccAddress) = $event)),\n          placeholder: \"Escrow Account Pubkey\",\n          disabled: _ctx.loading\n        }, null, 8, _hoisted_11), [\n          [_vModelText, _ctx.formState.escrowAccAddress]\n        ])\n      ]),\n      _createElementVNode(\"div\", _hoisted_12, [\n        _cache[13] || (_cache[13] = _createElementVNode(\"label\", { for: \"bob-x-token-amount\" }, \"Amount X tokens Bob wants\", -1)),\n        _withDirectives(_createElementVNode(\"input\", {\n          class: \"display-block\",\n          type: \"number\",\n          id: \"bob-x-token-amount\",\n          \"onUpdate:modelValue\": _cache[5] || (_cache[5] = ($event: any) => ((_ctx.formState.XTokenExpectedAmount) = $event)),\n          placeholder: \"Amount expected\",\n          min: \"0\",\n          disabled: _ctx.loading\n        }, null, 8, _hoisted_13), [\n          [_vModelText, _ctx.formState.XTokenExpectedAmount]\n        ])\n      ]),\n      _createElementVNode(\"div\", _hoisted_14, [\n        _createElementVNode(\"input\", {\n          style: {\"margin-right\":\"5px\"},\n          class: \"cursor-pointer border-none bg-btn normal-font-size\",\n          type: \"button\",\n          value: \"Reset UI\",\n          onClick: _cache[6] || (_cache[6] = \n//@ts-ignore\n(...args) => (_ctx.resetUI && _ctx.resetUI(...args))),\n          disabled: _ctx.loading\n        }, null, 8, _hoisted_15),\n        _createElementVNode(\"input\", {\n          class: \"cursor-pointer border-none bg-btn normal-font-size\",\n          type: \"button\",\n          value: \"Take trade\",\n          onClick: _cache[7] || (_cache[7] = \n//@ts-ignore\n(...args) => (_ctx.onTakeTrade && _ctx.onTakeTrade(...args))),\n          disabled: !_ctx.isFormValid || _ctx.loading\n        }, null, 8, _hoisted_16),\n        (_ctx.loading)\n          ? (_openBlock(), _createElementBlock(\"span\", _hoisted_17, \"Processing trade...\"))\n          : _createCommentVNode(\"\", true)\n      ]),\n      (_ctx.errorMessage)\n        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_18, _toDisplayString(_ctx.errorMessage), 1))\n        : _createCommentVNode(\"\", true),\n      (_ctx.successMessage)\n        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_19, _toDisplayString(_ctx.successMessage), 1))\n        : _createCommentVNode(\"\", true)\n    ])\n  ]))\n}"," \r\nimport { defineComponent, reactive, computed, ref } from 'vue';\r\nimport { takeTrade } from \"./util/takeTrade\";\r\n\r\nexport default defineComponent({\r\n    setup() {\r\n        const formState = reactive({\r\n            privateKey: \"\",\r\n            programId: \"\",\r\n            takerXAccAddress: \"\",\r\n            takerYAccAddress: \"\",\r\n            escrowAccAddress: \"\",\r\n            XTokenExpectedAmount: 0\r\n        })\r\n\r\n        const loading = ref(false);\r\n        const errorMessage = ref(\"\");\r\n        const successMessage = ref(\"\");\r\n\r\n        const isFormValid = computed(() => {\r\n            return (\r\n                formState.privateKey.trim() !== \"\" &&\r\n                formState.programId.trim() !== \"\" &&\r\n                formState.takerXAccAddress.trim() !== \"\" &&\r\n                formState.takerYAccAddress.trim() !== \"\" &&\r\n                formState.escrowAccAddress.trim() !== \"\" &&\r\n                formState.XTokenExpectedAmount > 0\r\n            );\r\n        });\r\n\r\n        const resetUI = () => {\r\n            formState.privateKey = \"\";\r\n            formState.programId = \"\";\r\n            formState.takerXAccAddress = \"\";\r\n            formState.takerYAccAddress = \"\";\r\n            formState.escrowAccAddress = \"\";\r\n            formState.XTokenExpectedAmount = 0;\r\n            errorMessage.value = \"\";\r\n            successMessage.value = \"\";\r\n        }\r\n        \r\n        const onTakeTrade = async () => {\r\n            if (!isFormValid.value) {\r\n                errorMessage.value = \"Please fill in all fields with valid values.\";\r\n                return;\r\n            }\r\n            \r\n            loading.value = true;\r\n            errorMessage.value = \"\";\r\n            successMessage.value = \"\";\r\n            \r\n            try {\r\n                await takeTrade(\r\n                    formState.privateKey,\r\n                    formState.escrowAccAddress,\r\n                    formState.takerXAccAddress,\r\n                    formState.takerYAccAddress,\r\n                    formState.XTokenExpectedAmount,\r\n                    formState.programId\r\n                );\r\n                successMessage.value = \"Success! Alice and Bob have traded their tokens and all temporary accounts have been closed\";\r\n            } catch (err) {\r\n                if (err instanceof Error) {\r\n                    errorMessage.value = err.message;\r\n                } else {\r\n                    errorMessage.value = String(err);\r\n                }\r\n            } finally {\r\n                loading.value = false;\r\n            }\r\n        }\r\n\r\n        return { \r\n            formState, \r\n            resetUI, \r\n            onTakeTrade, \r\n            loading, \r\n            errorMessage, \r\n            successMessage, \r\n            isFormValid \r\n        };\r\n    }\r\n})\r\n","import { render } from \"./Bob.vue?vue&type=template&id=eae670d4&ts=true\"\nimport script from \"./Bob.vue?vue&type=script&lang=ts\"\nexport * from \"./Bob.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"E:\\\\git\\\\solana-blockchain-development\\\\solana\\\\escrow\\\\escrow-ui\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { TOKEN_PROGRAM_ID } from \"@solana/spl-token\";\r\nimport { Account, Connection, PublicKey, Transaction, TransactionInstruction } from \"@solana/web3.js\";\r\nimport BN from \"bn.js\";\r\nimport { ESCROW_ACCOUNT_DATA_LAYOUT, EscrowLayout } from \"./layout\"; \r\n\r\nconst connection = new Connection(\"http://localhost:8899\", 'singleGossip');\r\n\r\nexport const takeTrade = async (\r\n    privateKeyByteArray: string,\r\n    escrowAccountAddressString: string,\r\n    takerXTokenAccountAddressString: string,\r\n    takerYTokenAccountAddressString: string,\r\n    takerExpectedXTokenAmount: number,\r\n    programIdString: string,\r\n) => {\r\n    const takerAccount = new Account(privateKeyByteArray.split(',').map(s => parseInt(s)));\r\n    const escrowAccountPubkey = new PublicKey(escrowAccountAddressString);\r\n    const takerXTokenAccountPubkey = new PublicKey(takerXTokenAccountAddressString);\r\n    const takerYTokenAccountPubkey = new PublicKey(takerYTokenAccountAddressString);\r\n    const programId = new PublicKey(programIdString);\r\n\r\n    let encodedEscrowState;\r\n    try {\r\n        encodedEscrowState = (await connection.getAccountInfo(escrowAccountPubkey, 'singleGossip'))!.data;\r\n    } catch (err) {\r\n        throw new Error(\"Could not find escrow at given address!\")\r\n    }\r\n    const decodedEscrowLayout = ESCROW_ACCOUNT_DATA_LAYOUT.decode(encodedEscrowState) as EscrowLayout;\r\n    const escrowState =  {\r\n        escrowAccountPubkey: escrowAccountPubkey,\r\n        isInitialized: !!decodedEscrowLayout.isInitialized,\r\n        initializerAccountPubkey: new PublicKey(decodedEscrowLayout.initializerPubkey),\r\n        XTokenTempAccountPubkey: new PublicKey(decodedEscrowLayout.initializerTempTokenAccountPubkey),\r\n        initializerYTokenAccount: new PublicKey(decodedEscrowLayout.initializerReceivingTokenAccountPubkey),\r\n        expectedAmount: new BN(decodedEscrowLayout.expectedAmount, 10, \"le\")\r\n    };\r\n\r\n    const PDA = await PublicKey.findProgramAddress([Buffer.from(\"escrow\")], programId);\r\n\r\n    const exchangeInstruction = new TransactionInstruction({\r\n        programId,\r\n        data: Buffer.from(Uint8Array.of(1, ...new BN(takerExpectedXTokenAmount).toArray(\"le\", 8))),\r\n        keys: [\r\n            { pubkey: takerAccount.publicKey, isSigner: true, isWritable: false },\r\n            { pubkey: takerYTokenAccountPubkey, isSigner: false, isWritable: true },\r\n            { pubkey: takerXTokenAccountPubkey, isSigner: false, isWritable: true },\r\n            { pubkey: escrowState.XTokenTempAccountPubkey, isSigner: false, isWritable: true},\r\n            { pubkey: escrowState.initializerAccountPubkey, isSigner: false, isWritable: true},\r\n            { pubkey: escrowState.initializerYTokenAccount, isSigner: false, isWritable: true},\r\n            { pubkey: escrowAccountPubkey, isSigner: false, isWritable: true },\r\n            { pubkey: TOKEN_PROGRAM_ID, isSigner: false, isWritable: false},\r\n            { pubkey: PDA[0], isSigner: false, isWritable: false}\r\n        ] \r\n    })    \r\n\r\n    await connection.sendTransaction(new Transaction().add(exchangeInstruction), [takerAccount], {skipPreflight: false, preflightCommitment: 'singleGossip'});\r\n}\r\n"],"sourceRoot":""}